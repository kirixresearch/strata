<!doctype html>
<html class="no-js" lang="">
   <head>
      <meta charset="utf-8">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      <title>Creating a "Hello World" Extension | Workstation Documentation</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="icon" href="../img/favicon.ico">
      <link rel="stylesheet" href="../css/style.css">
   </head>
   <body>
      <div id="page-wrapper">
         <a name="top" id="top"></a>
         <div id="page-content">
            <h1>Developer Resources</h1>
            <a id="c251"></a>
            <h2>Creating a "Hello World" Extension</h2>
            <p>While scripts can be run individually, sometimes you want to package them up so they can be run as part of the application, without the script being stored in the project or on in the filesystem, but instead existing as if it were part of the native functionality of the package.</p>
            <p>When scripts are packaged up this way and installed, they are called extensions.&nbsp; The extension encapsulates the functionality of the script, along with other resources such as bitmaps or data tables, into a single extension file.</p>
            <p>Then, when an extension is installed in the application, the scripts contained in the extension run each time Strata is opened, adding additional functionality to Strata as if it existed natively as part of the package.</p>
            <p>You can create an extension for Strata by packaging a script together with an XML file, called "info.xml." This XML file contains the information required to load and run the script as an extension in Strata.</p>
            <p>To see this in action, let's create a simple "Hello World" extension that shows a "Hello World" alert when we click on a menu item in the tools folder.</p>
            <p>First, create a script file called "main.js" to hold the primary contents of the extension:</p>
            <ol>
               <li>Go to the File menu and select New-&gt;Script, which will open a new text editor without any script.</li>
               <li>Go to the File menu and select "Save As External".</li>
               <li>In the "Save As" dialog, save the script as "main.js" to your desktop.</li>
            </ol>
            <p>Next, let's create the code that shows the "Hello World".&nbsp; Of course, showing a "Hello World" message is trivial, using the alert function; however, in our example, we want to show "Hello World" when we click on a menu item in Strata's Tools menu, and we want this to run this as an extension.&nbsp; So, we have to:</p>
            <ol>
               <li>Check if the script is running as an extension or standalone.</li>
               <li>If the script is running as an extension, insert a menu item into Strata's Tools menu.</li>
               <li>If the menu item is clicked, or the script is running standalone, show the "Hello World" message.</li>
            </ol>
            <p>First, check if the script is running as an extension or standalone.&nbsp; Although we don't need to do this to run the script as an extension, it allows us to develop the script to run as an extension, while still allowing us to run it directly without always inserting new menu items each time we run it, which we really only want to do once when we actually run it as an extension.</p>
            <p>So, to check if the script is running as an extension or standalone, use Extension.isContextPackage(), which returns true if the script is running as an extension, and false otherwise:</p>
            <pre>if (Extension.isContextPackage())<br>{<br>    // if the script is packaged as an extension, add a <br>    // menu item to the host application and connect the <br>    // menu item click event to a handler<br>}<br>else<br>{<br>    // if the script is not packaged as an extension, <br>    // simply show the alert message<br>}<br><br>// start the application event loop to process<br>// application events<br>Application.run();</pre>
            <p>Next, if the script is running as an extension, insert a menu item into Strata's Tools menu.&nbsp; For now, simply create an empty function "insertToolsMenuItem" that returns a menu item, and include it in the script as follows:</p>
            <pre>if (Extension.isContextPackage())<br>{<br>    // if the script is packaged as an extension, add a <br>    // menu item to the host application and connect the <br>    // menu item click event to a handler<br>    var item = insertToolsMenuItem("Hello World...");<br>}<br> else<br>{<br>    // if the script is not packaged as an extension, <br>    // simply show the alert message<br>    alert("Hello World");    <br>}<br><br>function insertToolsMenuItem(name)<br>{<br>}<br><br>// start the application event loop to process<br>// application events<br>Application.run();</pre>
            <p>Finally, if the menu item is clicked, or the script is running standalone, show the "Hello World" message.&nbsp; To do this, create a new function, "onHelloWorldMenuItemClicked", and connect the menu item's click event to this function, so that when the menu item is clicked, this function is run, showing the "Hello World" message:</p>
            <pre>if (Extension.isContextPackage())<br>{<br>    // if the script is packaged as an extension, add a <br>    // menu item to the host application and connect the <br>    // menu item click event to a handler<br>    var item = insertToolsMenuItem("Hello World...");<br>    item.click.connect(onHelloWorldMenuItemClicked);    <br>}<br> else<br>{<br>    // if the script is not packaged as an extension, <br>    // simply show the alert message<br>    alert("Hello World");    <br>}<br><br>function insertToolsMenuItem(name)<br>{<br>}<br><br>function onHelloWorldMenuItemClicked()<br>{<br>    alert("Hello World");<br>}<br><br>// start the application event loop to process<br>// application events<br>Application.run();</pre>
            <p>When we run this script, it shows "Hello World", as we expect.&nbsp; However, we still need to actually insert the menu item to show this message, as well as package the script up as an extension.&nbsp; To do this, we need to:</p>
            <ol>
               <li>Get Strata's Tools menu.</li>
               <li>Insert the new menu item into Strata's Tools menu.</li>
            </ol>
            <p>First, to get Strata's Tools menu, create a new function, called getToolsMenu(), as follows:</p>
            <pre>function getToolsMenu()<br>{<br>    // summary: returns the host application Tool menu item<br><br>    // get the host application's main menu<br>    var menu_bar = HostApp.getFrameMenu();<br>    var tools_menu;<br>    <br>    // get the Tool menu item; if it doesn't exist, create it<br>    var id = menu_bar.findMenu("Tools");<br>    if (id &lt; 0)<br>    {<br>        tools_menu = new Menu("Tools");<br>        menu_bar.insert(tools_menu, menu_bar.getMenuCount()-1);<br>    }<br>     else<br>    {<br>        tools_menu = menu_bar.getMenu(id);<br>    }<br>    <br>    return tools_menu;<br>}</pre>
            <p>Next, to insert the new menu item into Strata's Tools menu, fill out the insertToolsMenuItem() function we created earlier:</p>
            <pre>function insertToolsMenuItem(name)<br>{<br>    // summary: inserts a menu item with the given name in <br>    // an appropriate location in the host application's Tool <br>    // menu item<br><br>    // get the Tool menu item<br>    var tools_menu = getToolsMenu();<br>    <br>    // if the menu item already exists, first remove the<br>    // old menu item before we add the new menu item<br>    var item = tools_menu.findMenuItem(name);<br>    if (item)<br>        tools_menu.remove(item);<br>    <br>    // note: the 'click' event for this item must be connected<br>    // after this function is called<br>    item = new MenuItem(name);<br>    <br>    // the index of the separator right after the 'Projects...' <br>    // menu item<br>    var projects_pos = tools_menu.findMenuItem("Projects...") + 1;<br>    <br>    // the index of the separator right before the 'Options...' <br>    // menu item<br>    var options_pos = tools_menu.findMenuItem("Options...") - 1;<br>    <br>    // if we couldn't find one of the menu items, return<br>    if (projects_pos &lt; 0 || options_pos &lt; 0)<br>        return;<br>    <br>    // if these two menu items have the same index, we need <br>    // to insert another separator to make the 'Extensions Group'<br>    if (projects_pos == options_pos)<br>    {<br>        // this is the first extension menu item that is being<br>        // inserted in the 'Extensions Group'<br>        tools_menu.insertSeparator(projects_pos++);<br>        tools_menu.insert(item, projects_pos);<br>    }<br>     else<br>    {<br>        // we've already created the 'Extensions Group', all <br>        // we have to do is insert the menu item at the end <br>        // of the area<br>        tools_menu.insert(item, options_pos);<br>    }<br>    <br>    return item;<br>}</pre>
            <p>Putting the whole script together, and reorganizing it slightly, we have the following:</p>
            <pre>if (Extension.isContextPackage())<br>{<br>    // if the script is packaged as an extension, add a <br>    // menu item to the host application and connect the <br>    // menu item click event to a handler<br>    var item = insertToolsMenuItem("Hello World...");<br>    item.click.connect(onHelloWorldMenuItemClicked);    <br>}<br> else<br>{<br>    // if the script is not packaged as an extension, <br>    // simply show the alert message<br>    alert("Hello World");    <br>}<br><br>function onHelloWorldMenuItemClicked()<br>{<br>    alert("Hello World");<br>}<br><br>// start the application event loop to process<br>// application events<br>Application.run();<br><br><br><br>function getToolsMenu()<br>{<br>    // summary: returns the host application Tool menu item<br><br>    // get the host application's main menu<br>    var menu_bar = HostApp.getFrameMenu();<br>    var tools_menu;<br>    <br>    // get the Tool menu item; if it doesn't exist, create it<br>    var id = menu_bar.findMenu("Tools");<br>    if (id &lt; 0)<br>    {<br>        tools_menu = new Menu("Tools");<br>        menu_bar.insert(tools_menu, menu_bar.getMenuCount()-1);<br>    }<br>     else<br>    {<br>        tools_menu = menu_bar.getMenu(id);<br>    }<br>    <br>    return tools_menu;<br>}<br><br>function insertToolsMenuItem(name)<br>{<br>    // summary: inserts a menu item with the given name in <br>    // an appropriate location in the host application's Tool <br>    // menu item<br><br>    // get the Tool menu item<br>    var tools_menu = getToolsMenu();<br>    <br>    // if the menu item already exists, first remove the<br>    // old menu item before we add the new menu item<br>    var item = tools_menu.findMenuItem(name);<br>    if (item)<br>        tools_menu.remove(item);<br>    <br>    // note: the 'click' event for this item must be connected<br>    // after this function is called<br>    item = new MenuItem(name);<br>    <br>    // the index of the separator right after the 'Projects...' <br>    // menu item<br>    var projects_pos = tools_menu.findMenuItem("Projects...") + 1;<br>    <br>    // the index of the separator right before the 'Options...' <br>    // menu item<br>    var options_pos = tools_menu.findMenuItem("Options...") - 1;<br>    <br>    // if we couldn't find one of the menu items, return<br>    if (projects_pos &lt; 0 || options_pos &lt; 0)<br>        return;<br>    <br>    // if these two menu items have the same index, we need <br>    // to insert another separator to make the 'Extensions Group'<br>    if (projects_pos == options_pos)<br>    {<br>        // this is the first extension menu item that is being<br>        // inserted in the 'Extensions Group'<br>        tools_menu.insertSeparator(projects_pos++);<br>        tools_menu.insert(item, projects_pos);<br>    }<br>     else<br>    {<br>        // we've already created the 'Extensions Group', all <br>        // we have to do is insert the menu item at the end <br>        // of the area<br>        tools_menu.insert(item, options_pos);<br>    }<br>    <br>    return item;<br>}</pre>
            <p>Once we've created the main script, "main.js", we need to create a small information file that tells Strata about the script.&nbsp; This file is called "info.xml", and it's packaged up together with "main.js" into the extension file.</p>
            <p>To create the "info.xml" file:</p>
            <ol>
               <li>Go to the File menu and select New-&gt;Script, which will open a new text editor without any script.</li>
               <li>Go to the File menu and select "Save As External".</li>
               <li>In the "Save As" dialog, save the script as "info.xml" to your desktop.</li>
            </ol>
            <p>Then, in this file, enter the following and save it:</p>
            <pre>&lt;?xml version="1.0"&gt;<br>&lt;extension_info&gt;<br>    &lt;guid&gt;{9642c44c-f790-4f16-9d46-fb54fc97d1a7}&lt;/guid&gt;<br>    &lt;name&gt;Hello World Extension&lt;/name&gt;<br>    &lt;author&gt;Hello World Industries, Inc.&lt;/author&gt;<br>    &lt;bitmap&gt;icon.png&lt;/bitmap&gt;<br>    &lt;startup&gt;main.js&lt;/startup&gt;<br>    &lt;copyright&gt;(c) 2008 Hello World Industries, Inc.&lt;/copyright&gt;<br>    &lt;description&gt;A simple "Hello World" extension.&lt;/description&gt;<br>    &lt;major_version&gt;1&lt;/major_version&gt;<br>    &lt;minor_version&gt;0&lt;/minor_version&gt;<br>    &lt;subminor_version&gt;0&lt;/subminor_version&gt;<br>&lt;/extension_info&gt;</pre>
            <p>The fields in this "info.xml" file are as follows:</p>
            <p>&nbsp;</p>
            <ul>
               <li>&lt;guid&gt;&nbsp;&nbsp;&nbsp; Unique ID for the extension (generate using the extension wizard)</li>
               <li>&lt;name&gt;&nbsp;&nbsp;&nbsp; Name shown in the Extensions panel in the application.</li>
               <li>&lt;author&gt;&nbsp;&nbsp;&nbsp; Author of the extension.</li>
               <li>&lt;bitmap&gt;&nbsp;&nbsp;&nbsp; Bitmap shown in the Extensions panel in the application.</li>
               <li>&lt;startup&gt;&nbsp;&nbsp;&nbsp; Initial script file to be called when the extension is run.</li>
               <li>&lt;copyright&gt;&nbsp;&nbsp;&nbsp; Copyright information for the extension.</li>
               <li>&lt;description&gt;&nbsp;&nbsp;&nbsp; Description shown in the Extensions panel in the application.</li>
               <li>&lt;major_version&gt;&nbsp;&nbsp;&nbsp; Major version shown in the Extensions panel in the application.</li>
               <li>&lt;minor_version&gt;&nbsp;&nbsp;&nbsp; Minor version shown in the Extensions panel in the application.</li>
               <li>&lt;subminor_version&gt;&nbsp;&nbsp;&nbsp; Subminor version shown in the Extensions panel in the application.</li>
            </ul>
            <p>Once you've created this information file, it's time to package up the main.js file and the info.xml file into an extension, and install it.&nbsp; To do this:</p>
            <ol>
               <li>Zip up the newly create main.js and info.xml into a new zip file called hello_world.zip.</li>
               <li>Rename hello_world.zip to hello_world.kxt.&nbsp; The "kxt" extension tells Strata that the file in question is an extension.</li>
               <li>In Strata, go to the Tools menu and select Tools-&gt;Extensions.</li>
               <li>In the Extensions panel, click on the "Add Extensions…" button to add the hello_world.kxt extension.</li>
               <li>Then, when the "Hello World" extension appears in the list of extensions, press the "Start Now" button in the newly inserted extension.</li>
               <li>Close the Extensions panel and open the Tools menu again.</li>
               <li>Click on the newly inserted "Hello World…" item to show the "Hello World" message.</li>
            </ol>
         </div>
      </div>
   </body>
</html>
